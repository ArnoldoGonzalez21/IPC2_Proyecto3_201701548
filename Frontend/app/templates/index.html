{% extends "base.html" %}
{% block content %}
<section class="jumbotron text-center">
    <div class="container">
      <h1 class="jumbotron-heading">Superintendencia de Administración Tributaria</h1>
      <p class="lead text-muted">Autorización de Documento Tributario Electrónico (DTE)</p>
    
      <div class="card bg-primary text-white mb-4">
        <div class="card-body">Cargar Autorización:</div>
          <div class="card-footer d-flex align-items-center justify-content-between">
            <form method = "POST" enctype = "multipart/form-data">
            {% csrf_token %}
              <label for="archivo_entrada">Seleccionar Archivo:</label>
              <input type="file" id = "archivo_entrada" name = "archivo_entrada"/>
              <input class="btn btn-success btn-block" type="submit" value = "Enviar"/>
            </form>
          </div>
        </div>
      </div>
      <p>
        <a class="btn btn-secondary my-2" onclick="obtener_valores_select()">Peticiones</a>
        <select name="select_peticion" id = 'select_peticion'>
          <option value="1" selected>Consultar Datos</option>
          <option value="2" >Resumen de IVA</option>
          <option value="3">Resumen por rango de fechas</option>
          <option value="4">Gráfica</option>
          <option value="5">Reporte en PDF</option>
        </select>
        <div class="col-md-6">
          <div class="form-group">
          <label class="small mb-1" for="fecha">Fecha de Nacimiento</label>
          <input id="fecha" width="270" placeholder="Ingrese rango de fechas"/>
        </div>
        <a class="btn btn-secondary my-2" onclick="">Ayuda</a>
        <select name="select_ayuda" id = 'select_ayuda'>
          <option value="1" selected>Información Estudiante</option>
          <option value="2" >Documentación</option>
        </select>
      </p>
    </div>
  </section>
  
  <div class="album py-5 bg-light">
    <div class="container">
      <a class="btn btn-danger btn-block" id = "reset" name = "reset" onclick = "eliminar()">Reset</a>
      <div class="row">
        <div class="card-body">
          <textarea class="resizable" rows="10" cols="50" type="text" id = "txt_entrada" name = "txt_entrada" disabled>{{respuesta.contenido}}</textarea>
          <textarea class="resizable" rows="10" cols="50" type="text" id = "txt_salida" name = "txt_salida" disabled></textarea>
        </div>
      </div>
    </div>
  </div>
  <script>
    $('#fecha').datepicker({
      format: 'yyyy/mm/dd',
      uiLibrary: 'bootstrap'
    });
  </script>
  <script>
    const url = "http://localhost:3000/";
    
    async function eliminar(){
      let respuesta = await fetch(url + "reset_autorizaciones",{
        method: 'POST',
        body: 0,
        headers: {'Content-Type': 'application/json'}
      }).catch(function(error){
        console.log(error)
      });
      document.getElementById("txt_entrada").value = "";
      document.getElementById("txt_salida").value = "";
    }

    function obtener_datos(){
      let xhr = new XMLHttpRequest();
      xhr.open('GET', url + 'consultar_datos');
      xhr.send()
      xhr.onreadystatechange = (e) => {
        var datos = JSON.parse(xhr.responseText);
        contenido = datos.contenido;                                                    
        $("#txt_salida").val(contenido);
      }
    }

    function obtener_valores_select(){
      var valor = $("#select_peticion").val();
      switch (valor) {
        case '1':
          obtener_datos();
          break;
        case '2':
          console.log(2);
          break;
        case '3':
          console.log(3);
          break;
        case '4':
          console.log(4);
          break;
        case '5':
          console.log(5);
          break;      
        default:
          alert('Elija una opcion');
      }        
    }

  </script>
  <div id="layoutAuthentication_footer">
    <footer class="py-4 bg-light mt-auto">
      <div class="container-fluid">
        <div class="d-flex align-items-center justify-content-between small">
          <div class="text-muted">Arnoldo Luis Antonio González Camey</div>
          <div><a> &copy; 2021</a></div>
        </div>
      </div>
    </footer>
  </div>
  
        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
  {% endblock content %}